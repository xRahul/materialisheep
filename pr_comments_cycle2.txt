> [!WARNING]
> You have reached your daily quota limit. Please wait up to 24 hours and I will start processing your requests again!
/gemini review
@coderabbitai review
/review
@sourcery-ai review
@ellipsis review this
<!-- Generated by sourcery-ai[bot]: start review_guide -->

## Reviewer's Guide

Fixes two back-navigation crashes by making CustomTabs service binding lifecycle-safe and adjusting fragment lifecycle cleanup order, plus minor formatting and Javadoc tweaks.

#### Sequence diagram for CustomTabsDelegate bind/unbind lifecycle-safe behavior

```mermaid
sequenceDiagram
    actor User
    participant Activity
    participant ApplicationContext
    participant CustomTabsDelegate
    participant CustomTabsService

    User->>Activity: open link
    Activity->>CustomTabsDelegate: bindCustomTabsService(activity)
    CustomTabsDelegate->>CustomTabsDelegate: check mClient and mBound
    alt not already bound and package available
        Activity->>ApplicationContext: getApplicationContext()
        ApplicationContext->>CustomTabsService: bindCustomTabsService(pkg, connection)
        CustomTabsService-->>ApplicationContext: returns boolean bound
        ApplicationContext-->>CustomTabsDelegate: bound result
        CustomTabsDelegate->>CustomTabsDelegate: set mBound = true
        CustomTabsService-->>CustomTabsDelegate: onServiceConnected
        CustomTabsDelegate->>CustomTabsDelegate: set mClient, mCustomTabsSession
    else already bound or no package
        CustomTabsDelegate->>CustomTabsDelegate: return without binding
    end

    User->>Activity: navigate back
    Activity->>CustomTabsDelegate: unbindCustomTabsService(activity)
    CustomTabsDelegate->>CustomTabsDelegate: check mConnection and mBound
    alt connection exists and mBound is true
        Activity->>ApplicationContext: getApplicationContext()
        ApplicationContext->>ApplicationContext: try unbindService(mConnection)
        ApplicationContext-->>CustomTabsDelegate: may throw IllegalArgumentException
        CustomTabsDelegate->>CustomTabsDelegate: catch and ignore exception
        CustomTabsDelegate->>CustomTabsDelegate: set mClient = null
        CustomTabsDelegate->>CustomTabsDelegate: set mCustomTabsSession = null
        CustomTabsDelegate->>CustomTabsDelegate: set mConnection = null
        CustomTabsDelegate->>CustomTabsDelegate: set mBound = false
    else not bound
        CustomTabsDelegate->>CustomTabsDelegate: return without unbinding
    end
```

#### Class diagram for CustomTabsDelegate and fragment lifecycle changes

```mermaid
classDiagram
    class CustomTabsDelegate {
        - String ACTION_CUSTOM_TABS_CONNECTION
        - CustomTabsSession mCustomTabsSession
        - CustomTabsClient mClient
        - CustomTabsServiceConnection mConnection
        - boolean mBound
        + void bindCustomTabsService(Activity activity)
        + void unbindCustomTabsService(Activity activity)
        + boolean mayLaunchUrl(Uri uri, Bundle extras, List otherLikelyBundles)
        + CustomTabsSession getSession()
        + String getPackageNameToUse(Context context)
    }

    class BaseFragment {
        - boolean mAttached
        + void onCreate(Bundle savedInstanceState)
        + void onActivityCreated(Bundle savedInstanceState)
        + void onCreateOptionsMenu(Menu menu, MenuInflater inflater)
        + void onPrepareOptionsMenu(Menu menu)
        + void onDetach()
        + boolean isAttached()
        ..lifecycle change..
        + void onDetach() mAttached = false then super.onDetach()
    }

    class BaseListFragment {
        <<abstract>>
        - static String STATE_ADAPTER
        - CustomTabsDelegate mCustomTabsDelegate
        - KeyDelegate_RecyclerViewHelper mScrollableHelper
        - RecyclerView mRecyclerView
        - Preferences_Observable mPreferenceObservable
        + void onCreate(Bundle savedInstanceState)
        + void onViewCreated(View view, Bundle savedInstanceState)
        + void onActivityCreated(Bundle savedInstanceState)
        + void onSaveInstanceState(Bundle outState)
        + void onDetach()
        + void scrollToTop()
        + ItemRecyclerViewAdapter getAdapter()
        ..lifecycle change..
        + void onDetach() unsubscribe, mRecyclerView.setAdapter(null), super.onDetach()
    }

    class ItemFragment {
        - View mFragmentView
        - View mEmptyView
        - Item mItem
        - String mItemId
        - ItemManager mItemManager
        - SwipeRefreshLayout mSwipeRefreshLayout
        - SinglePageItemRecyclerViewAdapter_SavedState mAdapterItems
        - ItemRecyclerViewAdapter mAdapter
        - Preferences_Observable mPreferenceObservable
        + void onCreate(Bundle savedInstanceState)
        + View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
        + void onActivityCreated(Bundle savedInstanceState)
        + void onDestroy()
        + void onDetach()
        ..lifecycle change..
        + void onDetach() unsubscribe(getActivity()), super.onDetach()
    }

    class FavoriteFragment {
        - ActionMode mActionMode
        - String mFilter
        - boolean mSearchViewExpanded
        - FavoriteManager mFavoriteManager
        - ActionViewResolver mActionViewResolver
        - AlertDialogBuilder mAlertDialogBuilder
        - View mEmptySearchView
        - View mEmptyView
        + void onCreate(Bundle savedInstanceState)
        + View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
        + void onStart()
        + void onStop()
        + void onDetach()
        ..lifecycle change..
        + void onDetach() finish mActionMode, super.onDetach()
    }

    class WebFragment {
        - String EXTRA_ITEM
        - String STATE_EMPTY
        - String STATE_READABILITY
        - String ACTION_FULLSCREEN
        - String EXTRA_FULLSCREEN
        - int DEFAULT_PROGRESS
        - String PDF_LOADER_URL
        - String PDF_MIME_TYPE
        - WebView mWebView
        - NestedScrollView mScrollView
        - boolean mExternalRequired
        - ItemManager mItemManager
        - PopupMenu mPopupMenu
        - KeyDelegate_NestedScrollViewHelper mScrollableHelper
        - Preferences_Observable mPreferenceObservable
        - BroadcastReceiver mReceiver
        - ViewGroup mFullscreenView
        - ViewGroup mScrollViewContent
        - ImageButton mButtonRefresh
        - ViewSwitcher mControls
        - EditText mEditText
        - View mButtonMore
        - ProgressBar mProgressBar
        - String mContent
        - AppUtils_SystemUiHelper mSystemUiHelper
        - View mFragmentView
        - ReadabilityClient mReadabilityClient
        - FileDownloader mFileDownloader
        - WebItem mItem
        - boolean mIsHackerNewsUrl
        - boolean mEmpty
        - boolean mReadability
        - PdfAndroidJavascriptBridge mPdfAndroidJavascriptBridge
        + void onCreate(Bundle savedInstanceState)
        + View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
        + void onDestroy()
        + void onDetach()
        ..lifecycle change..
        + void onDetach() unsubscribe and unregister using getActivity(), super.onDetach()
    }

    BaseListFragment --|> BaseFragment
    ItemFragment --|> LazyLoadFragment
    WebFragment --|> LazyLoadFragment
    FavoriteFragment --|> BaseListFragment
    BaseListFragment --> CustomTabsDelegate
    ItemFragment --> Preferences_Observable
    WebFragment --> Preferences_Observable
    BaseListFragment --> Preferences_Observable

    class Preferences_Observable {
        + void subscribe(Context context)
        + void unsubscribe(Context context)
    }

    class KeyDelegate_RecyclerViewHelper
    class KeyDelegate_NestedScrollViewHelper
    class SinglePageItemRecyclerViewAdapter_SavedState
    class AppUtils_SystemUiHelper
    class FavoriteManager
    class ActionViewResolver
    class AlertDialogBuilder
    class ReadabilityClient
    class FileDownloader
    class ItemManager
    class WebItem
    class Item
    class ItemRecyclerViewAdapter
    class LazyLoadFragment
```

### File-Level Changes

| Change | Details | Files |
| ------ | ------- | ----- |
| Make CustomTabsDelegate service binding/unbinding lifecycle-safe to prevent IllegalArgumentException when navigating back. | <ul><li>Track service binding state with a mBound flag and short-circuit bind/unbind when inappropriate.</li><li>Use application context instead of the Activity instance for Custom Tabs service bind/unbind calls.</li><li>Guard unbindService in a try-catch to swallow IllegalArgumentException from redundant/unmatched unbinds.</li><li>Tighten early-return conditions when a client is already connected or binding has already occurred.</li></ul> | `app/src/main/java/io/github/hidroh/materialistic/CustomTabsDelegate.java` |
| Reorder fragment onDetach() cleanup to run before calling super to avoid getActivity() returning null during teardown. | <ul><li>Move super.onDetach() to the end of onDetach() implementations so cleanup using getActivity() runs while the fragment is still attached.</li><li>Ensure preference observable unsubscription, broadcast receiver unregister, RecyclerView adapter detach, and ActionMode finish happen before super.onDetach().</li></ul> | `app/src/main/java/io/github/hidroh/materialistic/BaseFragment.java`<br/>`app/src/main/java/io/github/hidroh/materialistic/BaseListFragment.java`<br/>`app/src/main/java/io/github/hidroh/materialistic/ItemFragment.java`<br/>`app/src/main/java/io/github/hidroh/materialistic/FavoriteFragment.java`<br/>`app/src/main/java/io/github/hidroh/materialistic/WebFragment.java` |
| Apply minor style and formatting cleanups for readability and consistency. | <ul><li>Normalize annotation placement and field declarations to one-per-line style.</li><li>Rewrap long method signatures, Javadocs, and chained calls to follow project formatting conventions.</li><li>Apply small code style tweaks such as spacing around casts and comments.</li></ul> | `app/src/main/java/io/github/hidroh/materialistic/WebFragment.java`<br/>`app/src/main/java/io/github/hidroh/materialistic/FavoriteFragment.java`<br/>`app/src/main/java/io/github/hidroh/materialistic/ItemFragment.java`<br/>`app/src/main/java/io/github/hidroh/materialistic/BaseListFragment.java`<br/>`app/src/main/java/io/github/hidroh/materialistic/BaseFragment.java`<br/>`app/src/main/java/io/github/hidroh/materialistic/CustomTabsDelegate.java` |

---

<details>
<summary>Tips and commands</summary>

#### Interacting with Sourcery

- **Trigger a new review:** Comment `@sourcery-ai review` on the pull request.
- **Continue discussions:** Reply directly to Sourcery's review comments.
- **Generate a GitHub issue from a review comment:** Ask Sourcery to create an
  issue from a review comment by replying to it. You can also reply to a
  review comment with `@sourcery-ai issue` to create an issue from it.
- **Generate a pull request title:** Write `@sourcery-ai` anywhere in the pull
  request title to generate a title at any time. You can also comment
  `@sourcery-ai title` on the pull request to (re-)generate the title at any time.
- **Generate a pull request summary:** Write `@sourcery-ai summary` anywhere in
  the pull request body to generate a PR summary at any time exactly where you
  want it. You can also comment `@sourcery-ai summary` on the pull request to
  (re-)generate the summary at any time.
- **Generate reviewer's guide:** Comment `@sourcery-ai guide` on the pull
  request to (re-)generate the reviewer's guide at any time.
- **Resolve all Sourcery comments:** Comment `@sourcery-ai resolve` on the
  pull request to resolve all Sourcery comments. Useful if you've already
  addressed all the comments and don't want to see them anymore.
- **Dismiss all Sourcery reviews:** Comment `@sourcery-ai dismiss` on the pull
  request to dismiss all existing Sourcery reviews. Especially useful if you
  want to start fresh with a new review - don't forget to comment
  `@sourcery-ai review` to trigger a new review!

#### Customizing Your Experience

Access your [dashboard](https://app.sourcery.ai) to:
- Enable or disable review features such as the Sourcery-generated pull request
  summary, the reviewer's guide, and others.
- Change the review language.
- Add, remove or edit custom review instructions.
- Adjust other review settings.

#### Getting Help

- [Contact our support team](mailto:support@sourcery.ai) for questions or feedback.
- Visit our [documentation](https://docs.sourcery.ai) for detailed guides and information.
- Keep in touch with the Sourcery team by following us on [X/Twitter](https://x.com/SourceryAI), [LinkedIn](https://www.linkedin.com/company/sourcery-ai/) or [GitHub](https://github.com/sourcery-ai).

</details>

<!-- Generated by sourcery-ai[bot]: end review_guide -->
> [!WARNING]
> You have reached your daily quota limit. Please wait up to 24 hours and I will start processing your requests again!
<!-- This is an auto-generated comment: summarize by coderabbit.ai -->
<!-- walkthrough_start -->

<details>
<summary>üìù Walkthrough</summary>

## Walkthrough

Reorders fragment teardown sequences so cleanup runs before calling super.onDetach() in several fragments; adds binding-state tracking to CustomTabsDelegate; introduces a new PdfAndroidJavascriptBridge.Callbacks.onLoad() method in WebFragment. Other edits are formatting and Javadoc reflows.

## Changes

| Cohort / File(s) | Summary |
|---|---|
| **Fragment lifecycle reordering** <br> `app/src/main/java/io/github/hidroh/materialistic/BaseFragment.java`, `app/src/main/java/io/github/hidroh/materialistic/BaseListFragment.java`, `app/src/main/java/io/github/hidroh/materialistic/FavoriteFragment.java`, `app/src/main/java/io/github/hidroh/materialistic/ItemFragment.java`, `app/src/main/java/io/github/hidroh/materialistic/WebFragment.java` | Moved `super.onDetach()` to occur after fragment-specific cleanup (e.g., unsubscribing, finishing action modes, releasing observers). Also includes Javadoc/formatting reflow across these files. |
| **CustomTabsDelegate binding logic** <br> `app/src/main/java/io/github/hidroh/materialistic/CustomTabsDelegate.java` | Added `private boolean mIsBound` to track binding state; prevent redundant binds, use application context for bind/unbind, wrap unbind in try-catch and reset client/session/connection/mIsBound on unbind. |
| **WebFragment interface change** <br> `app/src/main/java/io/github/hidroh/materialistic/WebFragment.java` | Added `void onLoad()` to nested `PdfAndroidJavascriptBridge.Callbacks` interface; other edits are formatting and minor code reflows. |

## Estimated code review effort

üéØ 3 (Moderate) | ‚è±Ô∏è ~20 minutes

## Poem

> üê∞ I hop through code with careful paws and cheer,  
> I nudge detachments later so cleanups run clear,  
> I mark binds with a flag, so services don't twine,  
> A new onLoad callback ‚Äî pages greet the sunshine,  
> Hooray for tidy hops and logic aligned!

</details>

<!-- walkthrough_end -->


<!-- pre_merge_checks_walkthrough_start -->

<details>
<summary>üö• Pre-merge checks | ‚úÖ 2 | ‚ùå 1</summary>

<details>
<summary>‚ùå Failed checks (1 warning)</summary>

|     Check name     | Status     | Explanation                                                                           | Resolution                                                                         |
| :----------------: | :--------- | :------------------------------------------------------------------------------------ | :--------------------------------------------------------------------------------- |
| Docstring Coverage | ‚ö†Ô∏è Warning | Docstring coverage is 38.24% which is insufficient. The required threshold is 80.00%. | Write docstrings for the functions missing them to satisfy the coverage threshold. |

</details>
<details>
<summary>‚úÖ Passed checks (2 passed)</summary>

|     Check name    | Status   | Explanation                                                                                                                                                                                                                                                                                    |
| :---------------: | :------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|    Title check    | ‚úÖ Passed | The title 'Fix app crash on back navigation (CustomTabs & Fragment Lifecycle)' directly and clearly summarizes the main objectives of the changeset, which addresses two distinct crashes during back navigation by fixing CustomTabs service binding and reordering Fragment lifecycle calls. |
| Description Check | ‚úÖ Passed | Check skipped - CodeRabbit‚Äôs high-level summary is enabled.                                                                                                                                                                                                                                    |

</details>

<sub>‚úèÔ∏è Tip: You can configure your own custom pre-merge checks in the settings.</sub>

</details>

<!-- pre_merge_checks_walkthrough_end -->

<!-- finishing_touch_checkbox_start -->

<details>
<summary>‚ú® Finishing touches</summary>

- [ ] <!-- {"checkboxId": "7962f53c-55bc-4827-bfbf-6a18da830691"} --> üìù Generate docstrings

</details>

<!-- finishing_touch_checkbox_end -->

<!-- tips_start -->

---

Thanks for using [CodeRabbit](https://coderabbit.ai?utm_source=oss&utm_medium=github&utm_campaign=sheepdestroyer/materialistic&utm_content=43)! It's free for OSS, and your support helps us grow. If you like it, consider giving us a shout-out.

<details>
<summary>‚ù§Ô∏è Share</summary>

- [X](https://twitter.com/intent/tweet?text=I%20just%20used%20%40coderabbitai%20for%20my%20code%20review%2C%20and%20it%27s%20fantastic%21%20It%27s%20free%20for%20OSS%20and%20offers%20a%20free%20trial%20for%20the%20proprietary%20code.%20Check%20it%20out%3A&url=https%3A//coderabbit.ai)
- [Mastodon](https://mastodon.social/share?text=I%20just%20used%20%40coderabbitai%20for%20my%20code%20review%2C%20and%20it%27s%20fantastic%21%20It%27s%20free%20for%20OSS%20and%20offers%20a%20free%20trial%20for%20the%20proprietary%20code.%20Check%20it%20out%3A%20https%3A%2F%2Fcoderabbit.ai)
- [Reddit](https://www.reddit.com/submit?title=Great%20tool%20for%20code%20review%20-%20CodeRabbit&text=I%20just%20used%20CodeRabbit%20for%20my%20code%20review%2C%20and%20it%27s%20fantastic%21%20It%27s%20free%20for%20OSS%20and%20offers%20a%20free%20trial%20for%20proprietary%20code.%20Check%20it%20out%3A%20https%3A//coderabbit.ai)
- [LinkedIn](https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fcoderabbit.ai&mini=true&title=Great%20tool%20for%20code%20review%20-%20CodeRabbit&summary=I%20just%20used%20CodeRabbit%20for%20my%20code%20review%2C%20and%20it%27s%20fantastic%21%20It%27s%20free%20for%20OSS%20and%20offers%20a%20free%20trial%20for%20proprietary%20code)

</details>

<sub>Comment `@coderabbitai help` to get the list of available commands and usage tips.</sub>

<!-- tips_end -->

<!-- internal state start -->


<!-- DwQgtGAEAqAWCWBnSTIEMB26CuAXA9mAOYCmGJATmriQCaQDG+Ats2bgFyQAOFk+AIwBWJBrngA3EsgEBPRvlqU0AgfFwA6NPEgQAfACgjoCEYDEZyAAUASpETZWaCrKPR1AGxJcAYvAAe6NzcjFSIsPxYAmgMANaQGGgS8ETU8PhYABQAwtiIBMzQKsgAZJA+VERsGLiQADLwAGaisgxeAJSQgCgE1nZmACwAzJBy9rAkJNxK+RT4spSQmQJUGAywXI0BAPRowWAMYbBgGWDRcWCJyaniGZCASYSQzGj5lO1uCMi2kJv+0pC4AHd8JBaEhxKtagdnuNkIJEJQpPQAeMsJcUmkMEQRjF4o1ZsxvhNaFt1CQCckSADkJkpBQmvA6JF0NYAiQPJAAIwABnaHCMUFy+RYRQEiAAImySNcSPYEfAGDLsBg1Bh6FDwgZILpIDZpPgPFJkEIkmgNB5MEQNABJDxeVIeACCFCIjnYAFF/AruDcMFwAMpyhUJfC1ChSsGUOgaTXagCq8OQMXEyVwsg0pFwDuCHnlaQy2QyNH8uEynUa+D48IoySDKuJSrr/2BZAcYYUGEQEdW8his0QibEknU8hzzQYrS8iGjWqgDtotETWGYACF8Er6I1zViCP8qHFZdX5TKmBhyIPbvlqDLMPReCQpDUQdhuDmGFetkqnrg1oyG/BVVOMZQAA6lQ3DIH+qoBoeQb/rusj7NQazfBW6DzoyiBoM0qbTtqbodtgYbIIKBQwMU9jiLa3xKueWBYTQfC4OMjCwBaJDRgYUAVGgVTsJAo4tG0MoAHJWG6QHWGGD64MgGYOoOKayKWkBhrghEYP+WIYNgVG0IRmnfJU1SQl4mDPiM8jMPgySYvYz6UBoGQSrgMSwMpO5MTKZD0PgjSRM5rnKXBy7PCQ3G8TUAA0kAhfCDT5OFxnRcBJACIl7DRVaNDMOlUXoKq5RJBWpK5ZoEn4a2fxCWZIQuYgsTUuxlrRUqDiigc8AqlieIsPwooIiok4tRgYZEBGdK2cs+BoLQb75Ig0VKC5awGTNuwMYgnQUEqkDIvAXj/MxeI8cZFH7eyrGJpAEhoDm9BJkOqYqSQzRhqs7FGAA8p5fBrGxiBcEwSgoRQX7gkQ0UAFImmK+AMCgzC8NZZLsAt+UYCGeZYOWoPUOD0U3o8/6oWGjRJhWU6QAAapQ9Jvj6XBKAI2BYg6VgANIjNg+21IT/6XradAANzYucaLXOkWDqjCz2IPqiIiyRvUisgtL0oyQIULEmkcV8sY2HUXCwLguDgRwWxbGNTHYAIGhMMwWzhBMUzSLgszzBQWxfrTt1gvKWzcDpHhbEM5iWAWrCo3ZTguPykDxgsTuTNMbtzAs/4SPgsSMlJDIAgoTgAYsABEltkv+Oi55SxfRaXVcAsXnSE8ZkuMgAAkDyiqOo2jRW3cuEQqLhgL3+X0G3bI5uBqA7ttWD14Bs50XgLBXvQBZKDYKhqLUAghosndUN3LnwAA2nvuAALpbdI3AZEotDRSemygwZ6i7edz0Uvnnksf9Y+HWoF/POu1ni7hSKQMMtBoxQDgDKC+wYaDICYkAjeJAt7Hx4JQHGzBkD/gOCjGot1gGUkXEiT+GNQwkDAPXdAHgwwzXkPXRk9tmDqEQCLd+OZ5qANqL/WhD1bgAjAdwbBFY2D0EyIAUHJIDyR9MgURFAcF0HaDAyAwlgRPG0sQ5hfBmh0DOLERaSAGB5E7BkaKJMSAAEdsCuxYaxTEfxdiiOcCgLAv8kbJAfgXYygEDAWEgBHNhtQ2D9h4n8BwMdXCcSCSwEJjxpCYVIFwYuupNjkCCXkAoKsJR2ivFwN6aA2CPFXOuJsjwrSIDKaqAm85+L4CIGNTE0UfhE37AZZg2Qcx8U2GyWgxcJJWlVLmJBzJSb/kIbvEgsh76HRlF8aYHVvSSy4L/KsNZqF73KZuHioDkBFIkRU5gVSamPwaU0gywjEzoXOYTNA7TOy2S6T0x8fSPBIjAT8RkcElaFGKHkqUV4NAwBhMeRxpBkBtGcE0eQ/4aCPnufU0EPEMb5HlP4/QxhwBQG8vwPyaAV7EDIMoGgap4nsC4LwPqIgFJ/FGIfbe6gtA6CxSYWBHwUCLhwAQYl5AqBkt8ZSlSaB85RKeC4CyCglBHx3iy3QYBDDYtMAYFxjsKAMC9toDAWxjQ3RJPgS26hYA2y2AgWgsxYBaoYvAX26LNWxTCkZdgGg9VoD5MXT1ATLAOitHy0lGFHASvkL5P+TjEBxwALLEz4NDG6tA4bPU3PgfOoall0hWbcIsuARYY1lFo8Q8M/pOLUU5Egy03KdAxvnZ8tArzIOYnjVyjJdlYgEC9Csx5bo5lsus+yGrzT9kSUxRQiw7zJDXIgDw8g3yC3oA4RRjkMABTWMpdtONFRTAxFiZgDoTbNtoLmlN8zGDdoqQuhyZaK3KThqYigiZGgMVlCbTpe6K2Mh3GTDw8JVGxL9DmIgxsk0eGPXBbgzhinloWAm0xxksYg0iNkBhNBPqZo7JGsg2Aj3UQhJLYh8BEZJjURo/gP0RgkFYhOqg7Ji2QvcYk7SoQSBYwDmGcDArJY8GoLAWEfAm1rFOpeGgkBHG0B7ZaIwccSO0b+DuTsRBEhqSIviyAJB/B3woGSgONtXyqZqOoBkHDgz2BSIpwiMorKgk2PTSWyAlqiDJRxBo5AoUQroFwAA1AAdi2GAfoRg3Tou9uS4GtCXo404JADDoJHAGE9YMziKq1WIA1Vq/8uqTQGqNdbAQZr4AWvwFa72dI7WFq2I6+KuBSqupNB6r1gTfX+oFYG6JKmZMRtidGjGejxF41WgVONM1E0AjAtwAy7X0AHHwEO3+0L+zYcaDRH0xCrOvTIAqRe1gdPylkVYK0jtTPUHMyCUQ5oOMZAgqsNzki83kFTXwMMVlESqfUxWQVbAR0Ln4HohkHzNpqOXBRpI6RqNhpSSe2d7I5P9qXSuyt+zHjIw3PiE9BAQihqvYFToHlmLeQJh4G1vbmIVhlSpmgzgE0AnnmyNIUgKkhnGL9Uy2kQiCI7BxMOsiCektsxU3+ShoXnY7CptTGnBWoUDgIXT7ADPSCk8CCbO5Jevi2KLt7jIZdPXk2ZoiHFAmRswE0V25R9oygdIkadAAvSgRhnNVWu55jk/RfMAE4AtBbXtKmUYXGgRa4NF+AsX4v8iS8EdVmqnjpbdVlq2Jrcvmstdan23Cyt/NyZKaUNWbp1cGQ1v1pB+We/Fc4ENfl2txznD4kDlzbIEbF4sOojSm4FQeXd9xDELcjH/KCWyQmZStsWCc6pa5VTY+BG7HEu1xhkfWYGGUqBtmqgB93gy1edu1s9zuE8nZScXwiC8hkiKCpD7OUe/O46o5hlOCv2vBL6HMdoPIRf90CpCmU3WAyREdK1Dgifkf9A8gDJf4XFXx4MTxs01FYxlQb8sQ194YN9BUdwMhp0eBZgFQNYURHgCxTwHNONUAMYMALgg4AFn9B9Tl/92gRZIIvtkgHkQDRlONwC1Mf8Ox8trx4JEJvxYBopq9Fx5AbR8lHRnRXQagPQvQfQCYCoiJy1kAD8MosDslhRigAwOkLEsCMgzwJCAE/91w1EutUJWF2AtgYMQYwYgCARmMGpFgmoNA6khBslGQe14EGErDCZEBwMGA34pZB1kBxgZoFhCYYMRCXIfRf0oAJRmYiAthq8KIrxTpwMmJUDpAEQ6BooARjVjNFtcMMhiFFdNE0BZA6hCUrtYwKBg4MwVDzEsAEieNyNZkCpf4P9e8QiZRRNxM9CY1TC+tbIZMENf4MZ+ZRFaIhVHw4IMxlxZgqRKBEBgJjU09lDnx68eoCQLYBiOwhifQ4kMBaRcAAAmGYZjJ4MbCpC2YMQY3A24bAnY/Yt2Q43YeADiKADDT7NCB+LgYSLYB0TrctWAUdbXI7NsBA9zdRT42JKmGFQab3MgSDWgd40EgUHwkzBTAEzdOtMlOEr4riX7e6W5LgAAA14EkCvBGHwH1GYyXHIPXDxPozm2QDxPmNFEBWlGpMyA8NiAiS4GS1S0jx1Wj3SGyzjzywKyKyvBKxT39gZPFAz2BTdTeAMDt1czYlhMgA812IAA5fMOQvN3dxBgsvcSF85ws3t/cY1JNvUucGIsZkFx9mIBczsrSRdXtNNGQJdtt4ZNdDN5dyBbdJlFSnFlSPMOQNSwBuQ4svVEswAjAuSI9tUMt9V+TY9TUE9Csk8xS/ZNUfAio6QaBqs3Uc9zTGsC8A150g0S82s3MOsnjOicFuisR2tOTbl+JJkRgXC8EsBBsTD014A0MyFZR2NPdMBKF4MnDkBljvhsS0Z0jEi814QC0ds68iNYkGgxwJxwU2IuBMdV0q1j0lBXpkAL0KBYdy0scKl6IFgMkkAEAejmdzJMhd1aJI1FB+8K5whOh+ZycfIy9u0DIDyjzr0yx4B70c1DpUBboNoIcz0Sd04PFbTjzkIBJxwhIuMmIOcCzuchdrST07SIN5FHSxcXS+BlcdsPS5dYlpMKy+dYLBcHTQ01dnSfJCK3S9NxBxBpAOJgAtEjd8gAB9TYLwQwZmfaaBIgKgMTEgAwYALVDSZoHivi8S+U30sHYEwMl3TU3YnUgjT3TuA01TX3Y0qLOgQPZgMMhLCASM1VMPFLGMqPTLBM41JM/LRPYrW1cUzVLKMkXM2rEygs/PElZrEs1rUNcvP9F8d+Zgb/eAMAJw9GTGXCnGE7URVUdbOFDAWlTYu89y5gA3RISBToKc34vAOhQnLEWczAQtTbdJEDCw+gDsxNfsj7aDaQZZXCncEbXYJslzBbJbPDGjNzNRXUKCqBfyOC9YYMGtAidqOkdtBRUmSMd6UcwC/IaKTyKWbtfcmHTcytEWcddIPIFAyHQNRdTa5SF+fIDo7rLol9WyGaew/IPxGkilGoXs5YGIaQbDOEAaKXeBIHKjXIisyArdQVB5Qwx8aKtqkIOCOsdmfLMUagOg1/X4gEKwWat6DbU82gW62oMG0bTSbDOApS1ChrdCh0nHGUbCjCvC9XBingJikiys9RBXCipXJi/4pTP4VCOirTIi90/TVi/xBUpSgM3YrkTUjkDSvU7Sn3P3AymLYy4PCMqMyy7k2Mvkw1RM+PRylM5y0rf2FKNKZ1GoLPd1byvPJrIvUsyVIKisqNas3rK6rEQmPaJBDw68DG7Je63sabfct2VfUkajXswc2K2zbDUq/TItNzejG6DwOxXjcjSjEHNRSvduP0WQGoafHbQOkIzjaK5YSw3s0mKqhDeEWkYhd5L7TIGw6KZgPWqmPOKu5cPAAgDAdJIiWAZvegUmcmIa/8NKzjKXOGBqLq7IzvGTNRYZYaitJ+a7E9QalTX846sffgBgO9dAR9BYMMUyJ5LED66saYkWMC6Y9sVOdkZNfOPSCaLEJaVyYyMerAcIFNZGl6OajbOwhw+gAADUjTqEgCtDFHQAoCoHkBrPtsMl6jb3hVPkvgAG8bANB/BmAPANA7w1t5ruKGE601AcxUwABfCpcBmoSByAKBnUOBhBpBlG9baQNBh/FQfaYcSAbB7DdteOgwvq2JceqwMUHwZ6JKi+ls/LUgZ9Z8NI0bFhC7N2bAMQVCZwF0D2qbIdEcoe2iP6tiW+59ZGxpIiNGIE+gTSwRoiNcDVa8DpBTU6HcYG1iSZNUM9fKomC64B8GJhn6kHAm9hrADMbIE1DAeIZmX3ROeAa3U9DwUxc0LQmaHxB5dw16+jWbZ4WoTIeFToCugqKAdtZpSg4zZh4HCsFbJoFBhUW+1OPSBUe6BISkYdX43RmChZWgRoc3ArfLQbRAZqiYgR9ibIbtQxNshiMmBULgTOfLSIRvGaUsEWHe57Wgk9FzQVeFbBaJmTEWMMWxQCv4OvLwFuHop85C2olBSESCjAYZ2gUsVCsyznB0Ymlqm0sm07HC3nWip08XRiqXYi3mz0txnp6J8J4EvEgZnyA56aI59oakuCaZn5GoOZoMPEqwWp+p2YRpk0ZpjNXAVp2gUgDQDp20Lp6k/KuCPE6MtLXk2ytW+yjW4U1Mly9MrYPWzym6PEkPcygWmTAMgANmZd8wAFZ/MDBAtdStKtmpb9KA8g9wysUJKcU9NPyeVCAiz/KRjIsqAxULan8Z0nzZVmVtAFVDB2VfF1BuL8tEBqHv46BuLLxNNNXlUoBaAORdjGhrXdivMGAOQGABAvNBg1TBgXXmWGB2WvN2WBBmXGgvMOQ0BmW3XBhl6XcvNaBmX+hzXtW0ASA1SuQORg3djBgOQXc/XGhBh2XGg1S0AORc2BA/WuRdjc2rW0B2X02M2GBo3zWxWIAdXcA9WFxDW85jW8U2VxW7xuK2BnQSBuKfw4gDXTXahRWoGYxi4kBPpaQ6R0IMBi4Nhbp4RIpJ2kBbBlwQM4g6Bgl2ArBpsyVF3vhl2SBV2tRi576dJaBN2B7bAj2v0V3J3QRaAbAlRYYGA/QfbMREBPHRBYgj2JHT2n38tX2MB3BcAvBf24gAPtogPz3n3QOJREXuyfQoP/2l3v04PIBi4e1s5aAqkHBpBP2KAj3PUz3sPB1cA0PdQHACdEAj3T4YwtQJ2tRWPsOh3YhhJINSPwODoOOa4mPWOL2Qi8gYO7FyO2Pi5RdzRFNJYePmIWKDoAByPwQIFxUIaEJkQxBIYHCWW4HIRQ/5UUSAMoUqeoI3RCjoJTkEFZsQFAwmaqMo+QYvOka3BtCzbVGlXAw0MnZidrctNIhAZCcJrR2TIEGz9FCEDTp2OzfSSaSfcWeDUYH4AySUg8TZLvEZa6qQkgQagyMzhC1coJ79DQATtj89yzEgUj4RCgDSTEMr8r4uMMZ+FIcze9k9iToT4qZpW6NDrjtgUjxTqrwT7Bzrljxrjj/rqr1Jd9mYVL5GSoKrzr89oTUTjDx98r7D6TzALGUj2br9ushbiJLlSAN1jQXY/oAAUin3lAiFQH5mwF93lEP00FBShOWaGqYlbv1F0eQCTY0C5C5Eu9K+W+w4Mejp9FI9AlJBBDhjm+/b6KOm6ou0eSAPGAJDkzSEQEaHkFmyO8Ea++kF+I+RB8E4q6fOq+cDq6IAa8k+6//F6/GDiCm9I5g3h6IHo5G7G7J/Y6Z84+45m6aqRc4zQ9p6E9W/o7WVg9B6k/Uxk929STQ/sG1mCEZAFCfIwR3kAEwCXwlII4LwKQdkFzuFZAaEr66BMX8npQSn2rzSS37D+ni3PrgX7DrstDQZNj7BmMS+cjnDuJ2wXj6b7DrzXY3Y2gLkNUsmZlwttUkgG1/oAQBUNUrzfoLzLkSNkgLkVKRoAQQYF3MtrCF3F3foNNpPhgLzEgF3PP3c2gF19P2gdltAQYBrv3/IWwJD5quT1JN8ZliYLzNAGIQYLkXv5lh1h1rkXcl3Zll3Ze71rkdllNtU2gfoBP6NxoF3XP5oF1+1tAfP1PrkQYB1kgLzbNhgFvtng7gsEu0gYZDvW6T9q8I98b89/FnkuMtAGPEloUpy0Uil+1crUKDSzQBP8eexcAgC5A8A+BkeHYI9rsRl5ZFaIMxY1PtwvqS9IA6lT3p12Liv8VaRLAUg5TJba1XKWwTMpnGzJOoToLqN1CAM25gDMYkA6AWgMGDwDGBsxJiCgM0hMCuegnbAUrWsqEt4yxLHLN/y1q/8daDqUKJViAE0DGu4A26FAOHpoD2WLAxQWwNgAcDv2R7QYNwMk44CbKgg/AaSx/42pxBWwSUkyRlImgZBknOQQwMUFaCVBiAtQRoI55aCdBQnPQQII/52VhByZEUiYOIGZVpBXAZ/kJ1sEKDEBR7foI4PkTOC4eB3NARgNY6jceBng9/p/18Ga1/ByeSltSwNqaBqBIQ0AeEMYFHstSMQ2zHEIYDs80BXIEbjGC95e8G2UAHtn21ICDs+eBrTtoqiAA -->

<!-- internal state end -->
<!-- This is an auto-generated reply by CodeRabbit -->
`@sheepdestroyer`: I'll review the changes in this PR right away!

<details>
<summary>‚úÖ Actions performed</summary>

Review triggered.

> Note: CodeRabbit is an incremental review system and does not re-review already reviewed commits. This command is applicable only when automatic reviews are paused.

</details>
## PR Compliance Guide üîç


<!-- https://github.com/sheepdestroyer/materialistic/commit/d12f1227c1cb7383b76c575b6f71a6383cc97d64 -->
Below is a summary of compliance checks for this PR:<br>
<table><tbody><tr><td colspan='2'><strong>Security Compliance</strong></td></tr>
<tr><td>üü¢</td><td><details><summary><strong>No security concerns identified</strong></summary>
No security vulnerabilities detected by AI analysis. Human verification advised for critical code.
</details></td></tr>
<tr><td colspan='2'><strong>Ticket Compliance</strong></td></tr>
<tr><td>‚ö™</td><td><details><summary>üé´ <strong>No ticket provided </strong></summary>


- [ ] Create ticket/issue <!-- /create_ticket --create_ticket=true -->

</details></td></tr>
<tr><td colspan='2'><strong>Codebase Duplication Compliance</strong></td></tr>
<tr><td>‚ö™</td><td><details><summary><strong>Codebase context is not defined </strong></summary>


Follow the <a href='https://qodo-merge-docs.qodo.ai/core-abilities/rag_context_enrichment/'>guide</a> to enable codebase context checks.

</details></td></tr>
<tr><td colspan='2'><strong>Custom Compliance</strong></td></tr>
<tr><td rowspan=4>üü¢</td><td>
<details><summary><strong>Generic: Comprehensive Audit Trails</strong></summary><br>

**Objective:** To create a detailed and reliable record of critical system actions for security analysis <br>and compliance.<br>

**Status:** Passed<br>


> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>
</details></td></tr>
<tr><td>
<details><summary><strong>Generic: Secure Error Handling</strong></summary><br>

**Objective:** To prevent the leakage of sensitive system information through error messages while <br>providing sufficient detail for internal debugging.<br>

**Status:** Passed<br>


> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>
</details></td></tr>
<tr><td>
<details><summary><strong>Generic: Secure Logging Practices</strong></summary><br>

**Objective:** To ensure logs are useful for debugging and auditing without exposing sensitive <br>information like PII, PHI, or cardholder data.<br>

**Status:** Passed<br>


> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>
</details></td></tr>
<tr><td>
<details><summary><strong>Generic: Security-First Input Validation and Data Handling</strong></summary><br>

**Objective:** Ensure all data inputs are validated, sanitized, and handled securely to prevent <br>vulnerabilities<br>

**Status:** Passed<br>


> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>
</details></td></tr>
<tr><td rowspan=1>üî¥</td>
<td><details>
<summary><strong>Generic: Robust Error Handling and Edge Case Management</strong></summary><br>

**Objective:** Ensure comprehensive error handling that provides meaningful context and graceful <br>degradation<br>

**Status:** <br><a href='https://github.com/sheepdestroyer/materialistic/pull/43/files#diff-ccbc9c613815b7fe56367db63b7143e1706e20bc9c58b007f68602c532f4d8a8R75-R83'><strong>Swallowed exception</strong></a>: <code>IllegalArgumentException</code> from <code>unbindService</code> is caught and silently ignored without logging <br>or actionable context, hindering debugging and incident reconstruction.<br>
<details open><summary>Referred Code</summary>

```java
void unbindCustomTabsService(Activity activity) {
    if (mConnection == null || !mBound) {
        return;
    }
    try {
        activity.getApplicationContext().unbindService(mConnection);
    } catch (IllegalArgumentException e) {
        // ignore
    }
```

</details>

> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>
</details></td></tr>
<tr><td rowspan=1>‚ö™</td>
<td><details>
<summary><strong>Generic: Meaningful Naming and Self-Documenting Code</strong></summary><br>

**Objective:** Ensure all identifiers clearly express their purpose and intent, making code <br>self-documenting<br>

**Status:** <br><a href='https://github.com/sheepdestroyer/materialistic/pull/43/files#diff-ccbc9c613815b7fe56367db63b7143e1706e20bc9c58b007f68602c532f4d8a8R51-R51'><strong>Boolean naming convention</strong></a>: The new boolean flag <code>mBound</code> does not follow the checklist‚Äôs preferred boolean naming style <br>(e.g., <code>isBound</code>/<code>hasBound</code>) and may reduce self-documentation depending on project <br>conventions.<br>
<details open><summary>Referred Code</summary>

```java
private boolean mBound;

```

</details>

> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>
</details></td></tr>

<tr><td align="center" colspan="2">

- [ ] Update <!-- /compliance --update_compliance=true -->

</td></tr></tbody></table>
<details><summary>Compliance status legend</summary>
üü¢ - Fully Compliant<br>
üü° - Partial Compliant<br>
üî¥ - Not Compliant<br>
‚ö™ - Requires Further Human Verification<br>
üè∑Ô∏è - Compliance label<br>
</details>
## PR Code Suggestions ‚ú®

<!-- d12f122 -->

Explore these optional code suggestions:

<table><thead><tr><td><strong>Category</strong></td><td align=left><strong>Suggestion&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </strong></td><td align=center><strong>Impact</strong></td></tr><tbody><tr><td rowspan=2>Possible issue</td>
<td>



<details><summary>Reset bound flag on service disconnection</summary>

___

**In <code>onServiceDisconnected()</code>, reset the <code>mBound</code> flag to <code>false</code> to allow the service <br>to be re-bound if the connection is lost.**

[app/src/main/java/io/github/hidroh/materialistic/CustomTabsDelegate.java [126-130]](https://github.com/sheepdestroyer/materialistic/pull/43/files#diff-ccbc9c613815b7fe56367db63b7143e1706e20bc9c58b007f68602c532f4d8a8R126-R130)

```diff
 @Synthetic
 void onServiceDisconnected() {
     mClient = null;
     mCustomTabsSession = null;
+    mBound = false;
 }
```



`[To ensure code accuracy, apply this suggestion manually]`


<details><summary>Suggestion importance[1-10]: 8</summary>

__

Why: The suggestion correctly identifies a state management bug introduced in the PR where `mBound` is not reset on service disconnection, preventing future re-binding and breaking the Custom Tabs feature.


</details></details></td><td align=center>Medium

</td></tr><tr><td>



<details><summary>Guard against negative buffer size</summary>

___

**Add a check to ensure <code>end</code> is greater than <code>begin</code> before calculating <code>bufferSize</code> to <br>prevent a potential <code>NegativeArraySizeException</code>.**

[app/src/main/java/io/github/hidroh/materialistic/WebFragment.java [692-693]](https://github.com/sheepdestroyer/materialistic/pull/43/files#diff-d396a0133f82cc518014ec6a1508b8127be56489fcbf10b0c6d11742e343b7e0R692-R693)

```diff
-final int bufferSize = (int) (end - begin);
+long chunkSize = end - begin;
+if (chunkSize <= 0) {
+    return "";
+}
+int bufferSize = (int) chunkSize;
 byte[] data = new byte[bufferSize];
```


- [ ] **Apply / Chat** <!-- /improve --apply_suggestion=1 -->


<details><summary>Suggestion importance[1-10]: 7</summary>

__

Why: The suggestion correctly identifies a potential `NegativeArraySizeException` if `end` is less than `begin` and provides a robust check to prevent a crash, improving the code's defensiveness.


</details></details></td><td align=center>Medium

</td></tr>
<tr><td align="center" colspan="2">

- [ ] Update <!-- /improve_multi --more_suggestions=true -->

</td><td></td></tr></tbody></table>
/gemini review
@coderabbitai review
/review
@sourcery-ai review
@ellipsis review this
Acknowledged. I am now processing your review request for this pull request.
<!-- This is an auto-generated reply by CodeRabbit -->
`@sheepdestroyer`: I'll review the changes in this pull request right away!

<details>
<summary>‚úÖ Actions performed</summary>

Review triggered.

> Note: CodeRabbit is an incremental review system and does not re-review already reviewed commits. This command is applicable only when automatic reviews are paused.

</details>
